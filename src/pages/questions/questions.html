<topbar [subTitle]    = "currentQuestion.subThreadName"
            [getAssessmentId] = "getAssessmentId"
    	      [mainTitle]   = "currentQuestion.threadName"
          	[questionLevel] = "currentQuestion.mrLevel"
            [currentQPos] = "this.currentQPos"
            [currentQSetAmt] = "this.currentQSetAmt"
    	      [values]="getQuestionValues()"
    	      [questionId]="currentQuestion.questionId"> </topbar>


<ion-content padding>
  <div class="qspacer">
  </div>
  <div class = "nav">
		<div style="display:flex;flex-direction:column">
		<div>
		<h2>{{currentQuestion.questionText}}</h2>
		</div>

		<div class="q-answer">
		<select [(ngModel)]="vals.currentAnswer" id="select-answer">
			<option value="skipped">Select Answer</option>
			<option value="Yes">Yes</option>
			<option value="No">No</option>
			<option value="N/A">N/A</option>
		</select>
		</div>
    <button class="help-button" *ngIf="currentQuestion.helpText" ion-button small color="buttonBlue" (click)="onHelpClicked()">Explanation Text</button>


    <div *ngIf="helpClicked" class="helpTextDiv">
      <!-- <p>help text</p> -->
      <p [innerHTML]="currentQuestion.helpText"></p>
    </div>
		</div>

    <div class="nav-q-buttons">
        <button ion-button color="buttonBlue" (click) = "handlePreviousPageClick()" id="previous-button">Previous</button>
        <button ion-button color="buttonBlue" (click) = "handleNextPageClick()" id="next-skip-button">Next/Skip</button>
    </div>

    <!-- <div class="nav-previous-qs">
      <h4>Navigate back to previous questions</h4>
      <p><a href="#">1. question</a></p>
      <p><a href="#">2. question</a></p>
      <p><a href="#">3. question</a></p>
      <p><a href="#">4. question</a></p>
      <p><a href="#">5. question</a></p>

    </div> -->
  </div>

  <div style="display:flex;flex-direction:row">
  <div style="width: 50%">
  <div *ngIf="vals.currentAnswer == undefined" class = "yes">
      <h6>Assumptions</h6>
      <textarea class="question-input" id="assumptions-input" [(ngModel)]="vals.assumptionsSkipped" placeholder="Enter any assumptions here..."></textarea>
      <h6>Notes</h6>
      <textarea class="question-input" id="notes-input" [(ngModel)]="vals.notesSkipped" placeholder="Enter notes here..."></textarea>
    </div>

  <div *ngIf="vals.currentAnswer == 'Yes'" class = "yes">
      <h6>Objective Evidence</h6>
      <textarea id="aaa objective-evidence-input" class="question-input" [(ngModel)]="vals.objectiveEvidence" placeholder="Enter objective evidence here..."></textarea>
      <h6>Assumptions</h6>
      <textarea class="question-input" id="yes-assumptions-input" [(ngModel)]="vals.assumptionsYes" placeholder="Enter any assumptions here..."></textarea>
      <h6>Notes</h6>
      <textarea class="question-input" id="yes-notes-input" [(ngModel)]="vals.notesYes" placeholder="Enter notes here..."></textarea>
      <div style="width:50%;margin:10px 0px 0px 0px;">
        <button (click)="showFileUpload()" id="yes-attach-file-button"ion-button color="dark">Attach File</button>
      </div>
    </div>



    <div *ngIf="vals.currentAnswer == 'No'" class = "no">
      <h3 style="margin-top:30px"><b>ACTION PLAN</b></h3>
				<!-- SAVE THIS FOR AUTH
      <div style="display:flex;flex-direction:row;justify-content:space-between;width:30%;height:60%;">
        <button style="background:white;">
          <label style="color:#32db64;font-size:16px;" (click)="addPerson(who.value)"><b>Add Action Person</b></label>
          <ion-icon name="add-circle" color = "secondary"></ion-icon>
        </button>
        <button style="background:white;">
          <label style="color:#f53d3d;font-size:16px;" (click)="removePerson()"><b>Remove</b></label>
          <ion-icon name="remove-circle" color = "danger"></ion-icon>
        </button>
      </div>
				-->
      <br>
      <br>
      <div style="margin-left: 2px;" class="who-when">
        <div style="display:flex; flex-direction:column" class="who">
          <li *ngFor = "let persons of actionPerson">
            <pre>{{persons}}</pre>
          </li>
          <h6>Who</h6>
          <input class="question-input" id="no-who-input" [(ngModel)]="vals.who" name="who" style="width: 200%;" #who>
        </div>
        <div style="display:flex; flex-direction:column" class='when'>
          <h6>When</h6>
          <input class="question-input" id="no-when-input" [(ngModel)]="vals.when" name= "when" type="date" >
        </div>
      </div>



      <!--
      <h6 class="risk-text">Risk</h6>

      <div class="risk">

				        <ion-label class="label"> Technical</ion-label>
								<ion-checkbox checked="false" id="no-risk-technical-box" [(ngModel)]="vals.technical"></ion-checkbox>
				        <ion-label class="label"> Cost</ion-label>
								<ion-checkbox checked="false" id="no-risk-cost-box" [(ngModel)]="vals.cost"></ion-checkbox>
				        <ion-label class="label"> Schedule</ion-label>
								<ion-checkbox checked="false" id="no-risk-schedule-box" [(ngModel)]="vals.schedule"></ion-checkbox>
      </div>
      -->
      
      <h6>What</h6>
      <textarea class="question-input" id="no-what-input" [(ngModel)]="vals.what" placeholder="What needs to be done to meet this objective?"></textarea>
      <h6>Reason</h6>
      <textarea class="question-input" id="no-reason-input" [(ngModel)]="vals.reason" placeholder="Reason that criteria is not met..."></textarea>
      <h6>Assumptions</h6>
      <textarea class="question-input" id="no-assumptions-input" [(ngModel)]="vals.assumptionsNo" placeholder="Enter any assumptions here..."></textarea>
      <h6>Notes</h6>
      <textarea class="question-input" id="no-notes-input" [(ngModel)]="vals.notesNo" placeholder="Enter notes here..."></textarea>
      <div class="attach" style="width:50%;margin:10px 0px 0px 0px;">
          <button id="no-attach-file-button" (click)="showFileUpload($event)" ion-button color="dark">Attach File</button>
      </div>
		 </div>

    <div *ngIf="vals.currentAnswer == 'N/A'" class = "na">
      <h6>Documentation</h6>
      <textarea class="question-input" id="na-documentation-input"[(ngModel)]="vals.documentation" placeholder="Document why this question is not applicable..."></textarea>
      <hr>
      <h6>Assumptions</h6>
      <textarea class="question-input" id="na-assumptions-input"[(ngModel)]="vals.assumptionsNA" placeholder="Enter any assumptions here..."></textarea>
      <h6>Notes</h6>
      <textarea class="question-input" id="na-notes-input"[(ngModel)]="vals.notesNA" placeholder="Enter notes here..."></textarea>
      <div style="width:50%; margin:10px 0px 0px 0px;">
        <button id="na-attach-file-button"(click)="showFileUpload($event)" ion-button color="dark">Attach File</button>
      </div>
    </div>



<div style="margin-top:20px" *ngIf="files.length > 0"class="displayFiles">
	<h6>Attachments</h6>
	<div *ngFor="let file of files" class="file">
                <p *ngIf="file.questionId == currentQuestion.questionId"><a href={{file.url}}>{{file.name}}</a></p>
		<!-- <img src="../../assets/imgs/redxMark.ico" class="img" (click)="handleFileRemove()"> -->
	</div>
</div>
  </div>
  <div style="width:50%">
          <h5>Risk Assessment</h5>
          <div style="display: flex">
          <div>
          <h6>Likelihood <img (click)="showRiskPopover('likelihood')" style="cursor:pointer" src="assets/imgs/qmark.png" width="15" height="15"></h6>
        
            <select [(ngModel)]="vals.likelihood" id="likelihood-input">
              <option value="1">1 - Not likely</option>
              <option value="2">2 - Low likelihood</option>
              <option value="3">3 - Moderate </option>
              <option value="4">4 - Highly likely</option>
              <option value="5">5 - Near Certainty</option>
            </select>
          </div>
          <div>
          <h6>Consequence</h6>
            <select [(ngModel)]="vals.consequence" id="consequence-input">
              <option value="1">1 - Negligible</option>
              <option value="2">2 - Marginal</option>
              <option value="3">3 - Moderate</option>
              <option value="4">4 - Critical</option>
              <option value="5">5 - Catastrophic</option>
            </select>
          </div>
          </div>

            <h6> Risk Score: {{calculateRiskScore()}}</h6>
            <div *ngIf="calculateRiskScore() > 11">
                    YOU AER AT RISK
          <h6>Greatest Impact</h6>
            <select [(ngModel)]="vals.impact" id="impact-input">
              <option value="cost">cost</option>
              <option value="schedule">schedule</option>
              <option value="performance">performance</option>
            </select>
          <h6>Risk Response</h6>
            <select [(ngModel)]="vals.response" id="response-input">
              <option value="accept">accept</option>
              <option value="transfer">transfer</option>
              <option value="avoid">avoid</option>
              <option value="mitigate">mitigate</option>
            </select>

            <h6>MMP Summary</h6>
            <textarea>
            </textarea>

            </div>
  </div>

  </div>

  <div class="qspacer"> </div>

</ion-content>
